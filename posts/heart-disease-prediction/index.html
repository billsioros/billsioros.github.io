<!doctype html><html><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta http-equiv=Accept-CH content="DPR, Viewport-Width, Width"><link rel=icon href=/fav.png type=image/gif><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Alata&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Alata&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" media=print onload='this.media="all"'><noscript><link href="https://fonts.googleapis.com/css2?family=Alata&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel=stylesheet></noscript><link rel=stylesheet href=/css/font.css media=all><meta property="og:url" content="https://billsioros.github.io/posts/heart-disease-prediction/"><meta property="og:site_name" content="Vassilis Sioros | Software / Machine Learning Engineer"><meta property="og:title" content="Heart Disease Prediction"><meta property="og:description" content="Decoding Heart Health with Data Insights!"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-08-23T00:00:00+00:00"><meta property="article:modified_time" content="2024-08-23T00:00:00+00:00"><meta property="article:tag" content="Python"><meta property="article:tag" content="Machine Learning"><meta property="article:tag" content="Data Science"><meta property="article:tag" content="Artificial Intelligence"><meta name=twitter:card content="summary"><meta name=twitter:title content="Heart Disease Prediction"><meta name=twitter:description content="Decoding Heart Health with Data Insights!"><link rel=stylesheet href=/bootstrap-5/css/bootstrap.min.css media=all><link rel=stylesheet href=/css/header.css media=all><link rel=stylesheet href=/css/footer.css media=all><link rel=stylesheet href=/css/theme.css media=all><style>:root{--text-color:#343a40;--text-secondary-color:#6c757d;--background-color:#eaedf0;--secondary-background-color:#64ffda1a;--primary-color:#007bff;--brand-color:#007bff;--secondary-color:#f8f9fa;--text-color-dark:#e4e6eb;--text-secondary-color-dark:#b0b3b8;--background-color-dark:#18191a;--secondary-background-color-dark:#212529;--primary-color-dark:#007bff;--brand-color-dark:#ffffff;--secondary-color-dark:#212529}body{min-height:100%;display:flex;flex-direction:column;font-size:1rem;font-weight:400;line-height:1.5;text-align:left}html{height:100%;background-color:var(--background-color)!important}body::-webkit-scrollbar{height:0;width:8px;background-color:var(--background-color)}::-webkit-scrollbar-track{border-radius:1rem}::-webkit-scrollbar-thumb{border-radius:1rem;background:#b0b0b0;outline:1px solid var(--background-color)}#search-content::-webkit-scrollbar{width:.5em;height:.1em;background-color:var(--background-color)}</style><meta name=description content="Decoding Heart Health with Data Insights!"><meta name=author content="Vassilis Sioros"><meta property="og:image" content="https://billsioros.github.io/images/posts/heart-disease-prediction/index.png"><link rel=stylesheet href=/css/single.css><script defer src=/fontawesome-6/all-6.4.2.js></script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.25.0/tocbot.css><script src=https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.25.0/tocbot.min.js></script><title>Heart Disease Prediction | Vassilis Sioros | Software / Machine Learning Engineer</title></head><body class=light><script>let localStorageValue=localStorage.getItem("pref-theme"),mediaQuery=window.matchMedia("(prefers-color-scheme: dark)").matches;switch(localStorageValue){case"dark":document.body.classList.add("dark");break;case"light":document.body.classList.remove("dark");break;default:mediaQuery&&document.body.classList.add("dark");break}</script><script>var prevScrollPos=window.pageYOffset;window.addEventListener("scroll",function(){let s=document.getElementById("profileHeader"),t=window.pageYOffset,n=!1,o=!1,i=o?prevScrollPos>t:t>0;i?s.classList.add("showHeaderOnTop"):n=!0,t===0&&(n=!0),n&&s.classList.remove("showHeaderOnTop"),prevScrollPos=t})</script><header id=profileHeader><nav class="pb-2 navbar navbar-expand-lg animate"><div class="container-fluid mx-xs-2 mx-sm-5 mx-md-5 mx-lg-5"><a class="navbar-brand primary-font text-wrap" href=/><img src=/fav.png width=30 height=30 class="d-inline-block align-top">
Vassilis Sioros</a><div class="d-flex justify-content-end" style=flex-grow:1><button id=theme-toggle type=checkbox></button></div><button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarContent aria-controls=navbarContent aria-expanded=false aria-label="Toggle navigation"><svg aria-hidden="true" height="24" viewBox="0 0 16 16" width="24" data-view-component="true"><path fill-rule="evenodd" d="M1 2.75A.75.75.0 011.75 2h12.5a.75.75.0 110 1.5H1.75A.75.75.0 011 2.75zm0 5A.75.75.0 011.75 7h12.5a.75.75.0 110 1.5H1.75A.75.75.0 011 7.75zM1.75 12a.75.75.0 100 1.5h12.5a.75.75.0 100-1.5H1.75z"/></svg></button><div class="collapse navbar-collapse text-wrap primary-font" style=flex-grow:0!important id=navbarContent><ul class="navbar-nav ms-auto text-center"><li class="nav-item navbar-text"><a class=nav-link href=/#experience aria-label=experience>Experience</a></li><li class="nav-item navbar-text"><a class=nav-link href=/#education aria-label=education>Education</a></li><li class="nav-item navbar-text"><a class=nav-link href=/#projects aria-label=projects>Projects</a></li><li class="nav-item navbar-text"><a class=nav-link href=/posts title="Blog posts">Blog</a></li></ul></div></div></nav></header><div id=content><section id=single><div class=container><div class="row justify-content-center"><div class="col-sm-12 col-md-12 col-lg-9"><div class=pr-lg-4><div class="title mb-5"><h1 class="text-center mb-4">Heart Disease Prediction</h1><h6 class="text-center mb-4">Decoding Heart Health with Data Insights!</h6><div class=text-center>Aug 23, 2024
<span id=readingTime>min read
</span><small>| </small><a target=_blank href=https://colab.research.google.com/github/billsioros/billsioros.github.io/blob/master/static/code/heart-disease-prediction.ipynb><img src=https://colab.research.google.com/assets/colab-badge.svg alt="Open In Colab"></a></div></div><div class=featured-image><img class="img-fluid mx-auto d-block" src=/images/posts/heart-disease-prediction/index.png alt="Heart Disease Prediction"></div><article class="page-content toc-content p-2"><p>Cardiovascular diseases (CVDs) are like the ultimate party crashers, claiming the lives of 17.9 million people every year‚Äîthat‚Äôs a whopping 31% of all deaths worldwide! Most of these are due to heart attacks and strokes, and what‚Äôs even scarier is that many victims are under 70. But what if we could see these crashers coming from a mile away? Enter machine learning: the superhero of the data world.</p><p>Machine learning models can dig through mountains of data to spot patterns and predict who might be at risk of heart disease. Think of them as your health fortune-tellers, using factors like high blood pressure, diabetes, and cholesterol levels to give you an early heads-up. With these models in action, we can catch potential heart problems before they turn into full-blown emergencies, helping to save lives and keep hearts happy.</p><p>In a <a href=https://billsioros.github.io/posts/exploratory-data-analysis/>previous post</a>, we conducted Exploratory Data Analysis (EDA) of the <a href=https://www.kaggle.com/datasets/fedesoriano/heart-failure-prediction>Heart Disease Prediction Dataset</a> and created a processed version of the dataset. In this post we will be training a machine learning model on this processed version of the dataset.</p><h2 id=overview>Overview</h2><p>As we previously determined during our EDA, the dataset contains 918 samples, each characterized by 11 distinct features. The dataset is balanced and contains no missing values, eliminating the need for imputation, row deletion, or oversampling. We had to exclude <code>RestingECG</code>, <code>RestingBP</code>, and <code>Cholesterol</code> from our analysis as they do not contribute meaningful information for predicting heart disease.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=n>Path</span><span class=o>.</span><span class=n>cwd</span><span class=p>()</span> <span class=o>/</span> <span class=s2>&#34;heart_processed.csv&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>df</span><span class=o>.</span><span class=n>head</span><span class=p>()</span>
</span></span></code></pre></div><table><thead><tr><th></th><th>Age</th><th>Sex</th><th>ChestPain</th><th>FastingBS</th><th>MaxHR</th><th>ExerciseAngina</th><th>Oldpeak</th><th>ST_Slope</th><th>HeartDisease</th></tr></thead><tbody><tr><td>0</td><td>40</td><td>M</td><td>ATA</td><td>0</td><td>172</td><td>N</td><td>0.0</td><td>Up</td><td>0</td></tr><tr><td>1</td><td>49</td><td>F</td><td>NAP</td><td>0</td><td>156</td><td>N</td><td>1.0</td><td>Flat</td><td>1</td></tr><tr><td>2</td><td>37</td><td>M</td><td>ATA</td><td>0</td><td>98</td><td>N</td><td>0.0</td><td>Up</td><td>0</td></tr><tr><td>3</td><td>48</td><td>F</td><td>ASY</td><td>0</td><td>108</td><td>Y</td><td>1.5</td><td>Flat</td><td>1</td></tr><tr><td>4</td><td>54</td><td>M</td><td>NAP</td><td>0</td><td>122</td><td>N</td><td>0.0</td><td>Up</td><td>0</td></tr></tbody></table><p>Before we proceed, we need to encode our categorical features. Instead of using <a href=https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelEncoder.html><code>LabelEncoder</code></a>, we&rsquo;ll handle this process manually to ensure compatibility with our REST API (which we&rsquo;ll develop in a future post üòù).</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>Sex</span><span class=p>(</span><span class=n>IntEnum</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>MALE</span> <span class=o>=</span> <span class=n>auto</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>FEMALE</span> <span class=o>=</span> <span class=n>auto</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ChestPain</span><span class=p>(</span><span class=n>IntEnum</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>TYPICAL_ANGINA</span> <span class=o>=</span> <span class=n>auto</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>ATYPICAL_ANGINA</span> <span class=o>=</span> <span class=n>auto</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>NON_ANGINAL_PAIN</span> <span class=o>=</span> <span class=n>auto</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>ASYMPTOMATIC</span> <span class=o>=</span> <span class=n>auto</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>StSlope</span><span class=p>(</span><span class=n>IntEnum</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>UP</span> <span class=o>=</span> <span class=n>auto</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>FLAT</span> <span class=o>=</span> <span class=n>auto</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>DOWN</span> <span class=o>=</span> <span class=n>auto</span><span class=p>()</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>df</span><span class=p>[</span><span class=s1>&#39;Sex&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;Sex&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>map</span><span class=p>({</span><span class=s1>&#39;M&#39;</span><span class=p>:</span> <span class=n>Sex</span><span class=o>.</span><span class=n>MALE</span><span class=p>,</span> <span class=s1>&#39;F&#39;</span><span class=p>:</span> <span class=n>Sex</span><span class=o>.</span><span class=n>FEMALE</span><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=n>df</span><span class=p>[</span><span class=s1>&#39;ChestPain&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;ChestPain&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>map</span><span class=p>({</span><span class=s1>&#39;ATA&#39;</span><span class=p>:</span> <span class=n>ChestPain</span><span class=o>.</span><span class=n>ATYPICAL_ANGINA</span><span class=p>,</span> <span class=s1>&#39;NAP&#39;</span><span class=p>:</span> <span class=n>ChestPain</span><span class=o>.</span><span class=n>NON_ANGINAL_PAIN</span><span class=p>,</span> <span class=s1>&#39;ASY&#39;</span><span class=p>:</span> <span class=n>ChestPain</span><span class=o>.</span><span class=n>ASYMPTOMATIC</span><span class=p>,</span> <span class=s1>&#39;TA&#39;</span><span class=p>:</span> <span class=n>ChestPain</span><span class=o>.</span><span class=n>TYPICAL_ANGINA</span><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=n>df</span><span class=p>[</span><span class=s1>&#39;ST_Slope&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;ST_Slope&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>map</span><span class=p>({</span><span class=s1>&#39;Up&#39;</span><span class=p>:</span> <span class=n>StSlope</span><span class=o>.</span><span class=n>UP</span><span class=p>,</span> <span class=s1>&#39;Flat&#39;</span><span class=p>:</span> <span class=n>StSlope</span><span class=o>.</span><span class=n>FLAT</span><span class=p>,</span> <span class=s1>&#39;Down&#39;</span><span class=p>:</span> <span class=n>StSlope</span><span class=o>.</span><span class=n>DOWN</span><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=n>df</span><span class=p>[</span><span class=s1>&#39;ExerciseAngina&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;ExerciseAngina&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>map</span><span class=p>({</span><span class=s1>&#39;Y&#39;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=s1>&#39;N&#39;</span><span class=p>:</span> <span class=kc>False</span><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=n>df</span><span class=o>.</span><span class=n>head</span><span class=p>()</span>
</span></span></code></pre></div><table><thead><tr><th></th><th>Age</th><th>Sex</th><th>ChestPain</th><th>FastingBS</th><th>MaxHR</th><th>ExerciseAngina</th><th>Oldpeak</th><th>ST_Slope</th><th>HeartDisease</th></tr></thead><tbody><tr><td>0</td><td>40</td><td>1</td><td>2</td><td>0</td><td>172</td><td>False</td><td>0.0</td><td>1</td><td>0</td></tr><tr><td>1</td><td>49</td><td>2</td><td>3</td><td>0</td><td>156</td><td>False</td><td>1.0</td><td>2</td><td>1</td></tr><tr><td>2</td><td>37</td><td>1</td><td>2</td><td>0</td><td>98</td><td>False</td><td>0.0</td><td>1</td><td>0</td></tr><tr><td>3</td><td>48</td><td>2</td><td>4</td><td>0</td><td>108</td><td>True</td><td>1.5</td><td>2</td><td>1</td></tr><tr><td>4</td><td>54</td><td>1</td><td>3</td><td>0</td><td>122</td><td>False</td><td>0.0</td><td>1</td><td>0</td></tr></tbody></table><h2 id=action-plan>Action Plan</h2><p>Based on our exploratory data analysis (EDA), we have already drawn the following conclusions:</p><ul><li>We will <a href=https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.OneHotEncoder.html>OneHotEncoder</a> to encode our categorical features.</li><li>Numerical features are not normally distributed and contain outliers. To address this we will employ <a href=https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.RobustScaler.html>RobustScaler</a>.</li><li>We will only consider models that are robust to multicollinearity. Our candidate models will be <a href=https://scikit-learn.org/stable/modules/svm.html><code>SVC</code></a>, <a href=https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html><code>RandomForestClassifier</code></a> and <a href=https://xgboost.readthedocs.io/en/stable/><code>XGBoost</code></a>.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>ModelChoice</span><span class=p>(</span><span class=n>IntEnum</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>SVC</span> <span class=o>=</span> <span class=n>auto</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>RANDOM_FOREST</span> <span class=o>=</span> <span class=n>auto</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>XGB</span> <span class=o>=</span> <span class=n>auto</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>create_pipeline</span><span class=p>(</span><span class=n>model_choice</span><span class=p>:</span> <span class=n>ModelChoice</span><span class=p>,</span> <span class=n>random_state</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>RANDOM_SEED</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>target_variable</span> <span class=o>=</span> <span class=s2>&#34;HeartDisease&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>categorical_features</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;Sex&#34;</span><span class=p>,</span> <span class=s2>&#34;ChestPain&#34;</span><span class=p>,</span> <span class=s2>&#34;FastingBS&#34;</span><span class=p>,</span> <span class=s2>&#34;ExerciseAngina&#34;</span><span class=p>,</span> <span class=s2>&#34;ST_Slope&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>numerical_features</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>set</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>columns</span><span class=p>)</span><span class=o>.</span><span class=n>difference</span><span class=p>([</span><span class=n>target_variable</span><span class=p>,</span> <span class=s2>&#34;RestingBP&#34;</span><span class=p>,</span> <span class=s2>&#34;Cholesterol&#34;</span><span class=p>,</span> <span class=o>*</span><span class=n>categorical_features</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>categorical_transformer</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>(</span><span class=n>steps</span><span class=o>=</span><span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=s1>&#39;onehot&#39;</span><span class=p>,</span> <span class=n>OneHotEncoder</span><span class=p>(</span><span class=n>handle_unknown</span><span class=o>=</span><span class=s1>&#39;ignore&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>numerical_transformer</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>(</span><span class=n>steps</span><span class=o>=</span><span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=s1>&#39;scaler&#39;</span><span class=p>,</span> <span class=n>RobustScaler</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>preprocessor</span> <span class=o>=</span> <span class=n>ColumnTransformer</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>transformers</span><span class=o>=</span><span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=s1>&#39;num&#39;</span><span class=p>,</span> <span class=n>numerical_transformer</span><span class=p>,</span> <span class=n>numerical_features</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=s1>&#39;cat&#39;</span><span class=p>,</span> <span class=n>categorical_transformer</span><span class=p>,</span> <span class=n>categorical_features</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>model_choice</span> <span class=o>==</span> <span class=n>ModelChoice</span><span class=o>.</span><span class=n>SVC</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>model</span> <span class=o>=</span> <span class=n>SVC</span><span class=p>(</span><span class=n>random_state</span><span class=o>=</span><span class=n>random_state</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>model_choice</span> <span class=o>==</span> <span class=n>ModelChoice</span><span class=o>.</span><span class=n>RANDOM_FOREST</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>model</span> <span class=o>=</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>random_state</span><span class=o>=</span><span class=n>random_state</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>model_choice</span> <span class=o>==</span> <span class=n>ModelChoice</span><span class=o>.</span><span class=n>XGB</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>model</span> <span class=o>=</span> <span class=n>XGBClassifier</span><span class=p>(</span><span class=n>random_state</span><span class=o>=</span><span class=n>random_state</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&#34;Invalid model choice&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>pipeline</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>(</span><span class=n>steps</span><span class=o>=</span><span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=s1>&#39;preprocessor&#39;</span><span class=p>,</span> <span class=n>preprocessor</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=s1>&#39;classifier&#39;</span><span class=p>,</span> <span class=n>model</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>pipeline</span>
</span></span></code></pre></div><h2 id=spiting-our-dataset>Spiting our Dataset</h2><p>We first need to split our dataset. We split the dataset into training and test sets to evaluate how well a model will perform on new, unseen data. The training set is used to teach the model, while the test set, helps assess its ability to generalize and make accurate predictions on unseen data. We‚Äôll use the <a href=https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html><code>train_test_split</code></a> function for this task. Specifically, we‚Äôll allocate 80% of the data for training and reserve 20% for evaluation.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>drop</span><span class=p>(</span><span class=s2>&#34;HeartDisease&#34;</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>),</span> <span class=n>df</span><span class=p>[</span><span class=s2>&#34;HeartDisease&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=n>RANDOM_SEED</span><span class=p>)</span>
</span></span></code></pre></div><h2 id=hyperparameter-tuning>Hyperparameter Tuning</h2><p>We&rsquo;ll use <a href=https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.RandomizedSearchCV.html><code>RandomizedSearchCV</code></a> to identify a good set of hyperparameters for our model. Unlike regular parameters that the model learns during training, hyperparameters are set manually and control aspects of the learning process. Unlike <a href=https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html><code>GridSearchCV</code></a>, which exhaustively tests all possible hyperparameter combinations, <code>RandomizedSearchCV</code> samples from the hyperparameter space at random. This approach can be more efficient and faster, especially when dealing with a large number of hyperparameters.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>hyperparameter_tuning</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>model_choice</span><span class=p>:</span> <span class=n>ModelChoice</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>X</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>y</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>param_distributions</span><span class=p>:</span> <span class=nb>dict</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>random_state</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>RANDOM_SEED</span>
</span></span><span class=line><span class=cl><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>pipeline</span> <span class=o>=</span> <span class=n>create_pipeline</span><span class=p>(</span><span class=n>model_choice</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>grid</span> <span class=o>=</span> <span class=n>RandomizedSearchCV</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>pipeline</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>param_distributions</span><span class=o>=</span><span class=n>param_distributions</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>n_iter</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>scoring</span><span class=o>=</span><span class=s1>&#39;f1&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>cv</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>verbose</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>random_state</span><span class=o>=</span><span class=n>random_state</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>n_jobs</span><span class=o>=-</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>grid</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span><span class=o>.</span><span class=n>best_params_</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>param_dist</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>ModelChoice</span><span class=o>.</span><span class=n>SVC</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;classifier__C&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mf>0.1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>10</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;classifier__kernel&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;rbf&#39;</span><span class=p>,</span> <span class=s1>&#39;sigmoid&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;classifier__gamma&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;scale&#39;</span><span class=p>,</span> <span class=s1>&#39;auto&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;classifier__class_weight&#39;</span><span class=p>:</span> <span class=p>[</span><span class=kc>None</span><span class=p>,</span> <span class=s1>&#39;balanced&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=n>ModelChoice</span><span class=o>.</span><span class=n>RANDOM_FOREST</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;classifier__n_estimators&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>100</span><span class=p>,</span> <span class=mi>200</span><span class=p>,</span> <span class=mi>300</span><span class=p>,</span> <span class=mi>400</span><span class=p>,</span> <span class=mi>500</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;classifier__max_depth&#39;</span><span class=p>:</span> <span class=p>[</span><span class=kc>None</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>40</span><span class=p>,</span> <span class=mi>50</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;classifier__min_samples_split&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>10</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;classifier__min_samples_leaf&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>4</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;classifier__bootstrap&#39;</span><span class=p>:</span> <span class=p>[</span><span class=kc>True</span><span class=p>,</span> <span class=kc>False</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=n>ModelChoice</span><span class=o>.</span><span class=n>XGB</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;classifier__n_estimators&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>100</span><span class=p>,</span> <span class=mi>200</span><span class=p>,</span> <span class=mi>300</span><span class=p>,</span> <span class=mi>400</span><span class=p>,</span> <span class=mi>500</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;classifier__learning_rate&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mf>0.01</span><span class=p>,</span> <span class=mf>0.05</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>,</span> <span class=mf>0.2</span><span class=p>,</span> <span class=mf>0.3</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;classifier__max_depth&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;classifier__reg_alpha&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>,</span> <span class=mf>0.2</span><span class=p>,</span> <span class=mf>0.3</span><span class=p>,</span> <span class=mf>0.4</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;classifier__reg_lambda&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>,</span> <span class=mf>0.2</span><span class=p>,</span> <span class=mf>0.3</span><span class=p>,</span> <span class=mf>0.4</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>best_params</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>model_choice</span> <span class=ow>in</span> <span class=n>tqdm</span><span class=p>(</span><span class=n>ModelChoice</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>params</span> <span class=o>=</span> <span class=n>hyperparameter_tuning</span><span class=p>(</span><span class=n>model_choice</span><span class=p>,</span> <span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>param_dist</span><span class=p>[</span><span class=n>model_choice</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>best_params</span><span class=p>[</span><span class=n>model_choice</span><span class=p>]</span> <span class=o>=</span> <span class=n>params</span>
</span></span></code></pre></div><h2 id=evaluating-our-model-candidates>Evaluating our Model Candidates</h2><p>To assess our model candidates, we&rsquo;ll employ 5-fold cross-validation. During 5-fold cross-validation the data is split into five equal parts (or folds). The model is trained on four of these parts and tested on the remaining one. This process is repeated five times, each time using a different fold as the test set. The results from all five tests are then averaged to give a more accurate measure of the model&rsquo;s performance. To this end we will be using <a href=https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.cross_validate.html><code>cross_validate</code></a> and employ accuracy, precision, recall, and F1 score as our metrics.</p><blockquote><p>Accuracy measures overall correctness, Precision evaluates positive prediction quality, Recall assesses sensitivity to positive instances, and F1 Score balances Precision and Recall.</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>metrics</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;accuracy&#39;</span><span class=p>,</span> <span class=s1>&#39;precision&#39;</span><span class=p>,</span> <span class=s1>&#39;recall&#39;</span><span class=p>,</span> <span class=s1>&#39;f1&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>results</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>model_choice</span> <span class=ow>in</span> <span class=n>tqdm</span><span class=p>(</span><span class=n>ModelChoice</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>model_name</span> <span class=o>=</span> <span class=n>model_choice</span><span class=o>.</span><span class=n>name</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&#34;_&#34;</span><span class=p>,</span> <span class=s2>&#34; &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>model_choice</span> <span class=o>==</span> <span class=n>ModelChoice</span><span class=o>.</span><span class=n>RANDOM_FOREST</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>model_name</span> <span class=o>=</span> <span class=n>model_name</span><span class=o>.</span><span class=n>title</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>results</span><span class=p>[</span><span class=n>model_name</span><span class=p>]</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=n>pipeline</span> <span class=o>=</span> <span class=n>create_pipeline</span><span class=p>(</span><span class=n>model_choice</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=n>RANDOM_SEED</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>pipeline</span> <span class=o>=</span> <span class=n>pipeline</span><span class=o>.</span><span class=n>set_params</span><span class=p>(</span><span class=o>**</span><span class=n>best_params</span><span class=p>[</span><span class=n>model_choice</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=n>cross_validate</span><span class=p>(</span><span class=n>pipeline</span><span class=p>,</span> <span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>cv</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>scoring</span><span class=o>=</span><span class=n>metrics</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>metric</span> <span class=ow>in</span> <span class=n>metrics</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>values</span> <span class=o>=</span> <span class=n>result</span><span class=p>[</span><span class=sa>f</span><span class=s1>&#39;test_</span><span class=si>{</span><span class=n>metric</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>mean</span> <span class=o>=</span> <span class=n>values</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>std</span> <span class=o>=</span> <span class=n>values</span><span class=o>.</span><span class=n>std</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>results</span><span class=p>[</span><span class=n>model_name</span><span class=p>][</span><span class=n>metric</span><span class=o>.</span><span class=n>title</span><span class=p>()]</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>mean</span> <span class=o>*</span> <span class=mi>100</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2> +/- </span><span class=si>{</span><span class=n>std</span> <span class=o>*</span> <span class=mi>100</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>results</span><span class=p>)</span><span class=o>.</span><span class=n>T</span>
</span></span></code></pre></div><table><thead><tr><th>Model</th><th>Accuracy</th><th>Precision</th><th>Recall</th><th>F1</th></tr></thead><tbody><tr><td>SVC</td><td>86.918 +/- 1.480</td><td>85.830 +/- 2.698</td><td>91.269 +/- 1.139</td><td>88.427 +/- 1.053</td></tr><tr><td>Random Forest</td><td>86.916 +/- 2.117</td><td>85.661 +/- 3.010</td><td>91.519 +/- 1.240</td><td>88.460 +/- 1.653</td></tr><tr><td>XGB</td><td>86.106 +/- 2.732</td><td>85.889 +/- 2.574</td><td>89.287 +/- 2.969</td><td>87.536 +/- 2.432</td></tr></tbody></table><p>In predicting heart disease, where missing a case can have serious consequences, we prioritize recall to ensure we catch as many cases as possible. Since <code>XGBoost</code> has the lowest recall, we‚Äôve decided not to pursue it further.</p><p>On the other hand, <code>RandomForestClassifier</code> offers the highest recall and has accuracy and F1 scores comparable to those of <code>SVC</code>. Thus, <code>RandomForestClassifier</code> emerges as the best choice for our model.</p><h2 id=testing-our-model>Testing our Model</h2><p>Having decided on the best model, we&rsquo;ll now test it on new data.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>pipeline</span> <span class=o>=</span> <span class=n>create_pipeline</span><span class=p>(</span><span class=n>model_choice</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=n>RANDOM_SEED</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pipeline</span> <span class=o>=</span> <span class=n>pipeline</span><span class=o>.</span><span class=n>set_params</span><span class=p>(</span><span class=o>**</span><span class=n>best_params</span><span class=p>[</span><span class=n>model_choice</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pipeline</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>y_pred</span> <span class=o>=</span> <span class=n>pipeline</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>classification_report</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>))</span>
</span></span></code></pre></div><pre><code>              precision    recall  f1-score   support

           0       0.75      0.86      0.80        77
           1       0.89      0.79      0.84       107

    accuracy                           0.82       184
   macro avg       0.82      0.83      0.82       184
weighted avg       0.83      0.82      0.82       184
</code></pre><p>As shown from the classification report, our model performs well on new data, showing a good balance across evaluation metrics. The confusion matrix below confirms this, indicating that most samples are classified correctly with only a few false negatives.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span> <span class=mi>6</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>sns</span><span class=o>.</span><span class=n>heatmap</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>confusion_matrix</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>),</span> <span class=n>annot</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>fmt</span><span class=o>=</span><span class=s1>&#39;d&#39;</span><span class=p>,</span> <span class=n>cmap</span><span class=o>=</span><span class=s1>&#39;Blues&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>cbar</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>square</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>xticklabels</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;No Heart Disease&#39;</span><span class=p>,</span> <span class=s1>&#39;Heart Disease&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=n>yticklabels</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;No Heart Disease&#39;</span><span class=p>,</span> <span class=s1>&#39;Heart Disease&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>&#39;Predicted Label&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>&#39;True Label&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></div><p><img src=/images/posts/heart-disease-prediction/confusion_matrix.png alt="Confusion Matrix"></p><h2 id=using-our-model>Using Our Model</h2><p>Our model can be used to make predictions with the following code:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;Age&#34;</span><span class=p>:</span> <span class=mi>20</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;Sex&#34;</span><span class=p>:</span> <span class=n>Sex</span><span class=o>.</span><span class=n>MALE</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;ChestPain&#34;</span><span class=p>:</span> <span class=n>ChestPain</span><span class=o>.</span><span class=n>ASYMPTOMATIC</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;FastingBS&#34;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;MaxHR&#34;</span><span class=p>:</span> <span class=mi>60</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;ExerciseAngina&#34;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;Oldpeak&#34;</span><span class=p>:</span> <span class=mf>0.0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;ST_Slope&#34;</span><span class=p>:</span> <span class=n>StSlope</span><span class=o>.</span><span class=n>DOWN</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pipeline</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>([</span><span class=n>payload</span><span class=p>]))[</span><span class=mi>0</span><span class=p>]</span>
</span></span></code></pre></div><p>We use <a href=https://scikit-learn.org/stable/modules/model_persistence.html><code>joblib</code></a> to save our model for future use.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>joblib</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>pipeline</span><span class=p>,</span> <span class=n>Path</span><span class=o>.</span><span class=n>cwd</span><span class=p>()</span> <span class=o>/</span> <span class=s2>&#34;model.joblib&#34;</span><span class=p>)</span>
</span></span></code></pre></div><p>Stay tuned for our upcoming post, where we&rsquo;ll dive into building a FastAPI backend for our model. Exciting developments are just around the corner! üöÄ</p></article></div></div><div class="col-sm-12 col-md-12 col-lg-3"><div id=stickySideBar class=sticky-sidebar><div id=toc-wrapper><aside class=toc></aside></div><aside class=tags><ul class="tags-ul list-unstyled list-inline mb-0 text-center"><li class="list-inline-item m-1"><a href=https://billsioros.github.io/tags/python target=_blank>Python</a></li><li class="list-inline-item m-1"><a href=https://billsioros.github.io/tags/machine-learning target=_blank>Machine Learning</a></li><li class="list-inline-item m-1"><a href=https://billsioros.github.io/tags/data-science target=_blank>Data Science</a></li><li class="list-inline-item m-1"><a href=https://billsioros.github.io/tags/artificial-intelligence target=_blank>Artificial Intelligence</a></li></ul></aside><aside class="social text-center"><div class="social-content mb-0"><ul class="list-inline mb-0"><li class="list-inline-item text-center"><a target=_blank href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fbillsioros.github.io%2fposts%2fheart-disease-prediction%2f"><i class="fab fa-linkedin"></i></a></li><li class="list-inline-item text-center"><a target=_blank href="https://twitter.com/share?text=Heart%20Disease%20Prediction&url=https%3a%2f%2fbillsioros.github.io%2fposts%2fheart-disease-prediction%2f"><i class="fab fa-twitter"></i></a></li><li class="list-inline-item text-center"><a target=_blank href='mailto:?subject=Heart%20Disease%20Prediction&amp;body=Check%20out%20this%20site https%3a%2f%2fbillsioros.github.io%2fposts%2fheart-disease-prediction%2f'><i class="fa fa-envelope"></i></a></li></ul></div></aside><div style=display:flex;flex-direction:row;justify-content:space-between><a href=https://billsioros.github.io/posts/exploratory-data-analysis/ class="article-control previousPost"><i class="fas fa-angle-left"></i>
<span class="text-muted font-weight-light mx-2">Previous</span></a></div></div></div></div><div class=row><div class="col-sm-12 col-md-12 col-lg-9 p-4"></div></div></div><button class="p-2 px-3" onclick=topFunction() id=topScroll>
<i class="fas fa-angle-up"></i></button></section><div class=progress><div id=scroll-progress-bar class=progress-bar role=progressbar aria-valuenow=0 aria-valuemin=0 aria-valuemax=100></div></div><script src=/js/scrollProgressBar.js></script><script>var topScroll=document.getElementById("topScroll");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?topScroll.style.display="block":topScroll.style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}let stickySideBarElem=document.getElementById("stickySideBar"),stickyNavBar=!0;if(stickyNavBar){let e=document.getElementById("profileHeader"),t=e.offsetHeight+15;stickySideBarElem.style.top=t+"px"}else stickySideBarElem.style.top="50px"</script><script src=/js/readingTime.js></script><script>tocbot.init({tocSelector:".toc",contentSelector:".toc-content",headingSelector:"h1, h2, h3",hasInnerContainers:!0})</script></div><footer class="d-flex flex-column justify-content-end" style=flex-grow:1><div class="container py-4"><div class="row justify-content-center"><div class="col-md-4 text-center">&copy; 2024 All rights reserved</div></div></div></footer><script src=/bootstrap-5/js/bootstrap.bundle.min.js></script><script>const button_=document.getElementById("theme-toggle");localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?(document.body.classList.remove("dark"),button_.classList.add("light")):window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><script>const button=document.getElementById("theme-toggle");button.addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),button.classList.toggle("light"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),button.classList.toggle("light"),localStorage.setItem("pref-theme","dark"))});var tooltipTriggerList=[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]')),tooltipList=tooltipTriggerList.map(function(e){return new bootstrap.Tooltip(e)})</script><script src=/js/search.js></script></body></html>